version: '3.4'

services:
    api:
        build: ../..
        image: multyio/steem-back:v0.1
        links:
            - steem-witness:steem-witness
        env_file:
            - env.api.secret
        environment:
            - "MULTY_STEEM_NET=steem"
            - "MULTY_STEEM_PORT=80"
            - "MULTY_STEEM_NODE=ws://steem-witness:8090"
        ports:
            - "80"

    steem-seed:
        image: steemit/steem:latest
        env_file:
            - env.steem.secret
        environment:
            - "STEEMD_P2P_ENDPOINT=0.0.0.0:2001"
            - "STEEMD_EXTRA_OPTS=--enable-stale-production"
        volumes:
           - "./seed_chain_data:/var/lib/golosd" #For local
        #expose:
        #    - "8090"
        ports:
        #    - "8090"
            - "2001"

    steem-witness:
        image: steemit/steem:latest
        env_file:
            - env.steem.secret
        links:
            - steem-seed:steem-seed
        environment:
            - "STEEMD_SEED_NODES=golos-seed:2001"
            - "STEEMD_EXTRA_OPTS=--enable-stale-production"
        volumes:
           - "./witness_chain_data:/var/lib/golosd" #For local
        expose:
            - "8090"
        ports:
            - "8090"
